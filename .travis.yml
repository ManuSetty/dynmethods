language: r
sudo: required
dist: trusty
bioc_required: true
cache:
  timeout: 2000
  apt: true
  directories:
    - $HOME/.cache/pip
    - $HOME/R
warnings_are_errors: true
python:
  - "3.6"
env:
  global:
    - R_MAX_NUM_DLLS=250
addons:
  apt:
    packages:
      - libgsl-dev
      - libsdl1.2-dev
      - libreadline-dev
      - imagemagick
      - libfftw3-dev
      - libudunits2-dev
      - libblas-dev
      - liblapack-dev
      - python3-pip
before_install:
 - sudo pip3 install --upgrade pip setuptools wheel
 - python3 -V
 - pip3 -V
install:
 - pip3 install --user --upgrade --only-binary=numpy,scipy numpy scipy
 - pip3 install --user --upgrade matplotlib pandas six jinja2 python-dateutil pytz pyparsing cycler tqdm python-igraph Cython statsmodels sklearn seaborn h5py anndata
 - R -e 'for (pa in c("devtools", "covr")) { if (pa %in% rownames(installed.packages())) update.packages(oldPkgs = pa, ask = FALSE) else install.packages(pa) }'
 - R -e 'setRepositories(ind = 1:2)'
 - R -e 'devtools::install(dependencies = T, upgrade = T)'
 - R -e 'dynmethods::check_dependencies()'
after_success:
 - R -e 'library(covr); codecov()'
